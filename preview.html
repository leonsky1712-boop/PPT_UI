<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI PPT Generator - æ¼”ç¤ºæ–‡ç¨¿ç”Ÿæˆ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .header h1 {
      font-size: 3em;
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }
    
    .header p {
      color: rgba(255,255,255,0.9);
      font-size: 1.2em;
    }
    
    .card {
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 40px;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
    }
    
    .section { margin-bottom: 30px; }
    
    .section h3 {
      font-size: 1.2em;
      color: #333;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .input-group {
      margin-bottom: 20px;
    }
    
    .input-group label {
      display: block;
      font-size: 0.9em;
      color: #666;
      margin-bottom: 8px;
    }
    
    .input-group input, .input-group select {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 1em;
      transition: all 0.3s;
    }
    
    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102,126,234,0.1);
    }
    
    .template-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }
    
    .template-option {
      padding: 20px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .template-option:hover {
      border-color: #667eea;
    }
    
    .template-option.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102,126,234,0.1), rgba(118,75,162,0.1));
    }
    
    .template-preview {
      height: 60px;
      border-radius: 8px;
      margin-bottom: 10px;
    }
    
    .template-name {
      font-weight: 600;
      color: #333;
    }
    
    .template-desc {
      font-size: 0.85em;
      color: #888;
    }
    
    .btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(102,126,234,0.4);
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .result {
      margin-top: 30px;
      padding: 20px;
      background: #f0f9ff;
      border-radius: 12px;
      display: none;
    }
    
    .result.show { display: block; }
    
    .result a {
      display: inline-block;
      padding: 12px 30px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 500;
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 40px;
    }
    
    .loading.show { display: block; }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(102,126,234,0.3);
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .info-box {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 20px;
      margin-top: 30px;
    }
    
    .info-box h4 {
      color: #333;
      margin-bottom: 10px;
    }
    
    .info-box p {
      color: #666;
      font-size: 0.9em;
      line-height: 1.6;
    }
    
    .command-box {
      background: #1e293b;
      color: #e2e8f0;
      padding: 20px;
      border-radius: 12px;
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 0.9em;
      margin-top: 20px;
      overflow-x: auto;
    }
    
    .command-box code {
      color: #f093fb;
    }
    
    .row {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ¯ AI PPT Generator</h1>
      <p>æ™ºèƒ½æ¼”ç¤ºæ–‡ç¨¿ç”Ÿæˆå¹³å°</p>
    </div>
    
    <div class="card">
      <!-- æ¼”ç¤ºä¸»é¢˜ -->
      <div class="section">
        <h3>ğŸ“ æ¼”ç¤ºä¸»é¢˜</h3>
        <div class="input-group">
          <label>è¯·è¾“å…¥æ¼”ç¤ºä¸»é¢˜</label>
          <input type="text" id="topic" placeholder="ä¾‹å¦‚ï¼š2024å¹´Q4äº§å“é”€å”®å›é¡¾">
        </div>
        <div class="row">
          <div class="input-group">
            <label>è¡Œä¸š/é¢†åŸŸ</label>
            <input type="text" id="industry" placeholder="ä¾‹å¦‚ï¼šç§‘æŠ€ã€æ•™è‚²">
          </div>
          <div class="input-group">
            <label>æ¼”è®²è€…</label>
            <input type="text" id="author" placeholder="æ‚¨çš„åå­—">
          </div>
        </div>
      </div>
      
      <!-- æ¼”ç¤ºç±»å‹ -->
      <div class="section">
        <h3>ğŸ“Š æ¼”ç¤ºç±»å‹</h3>
        <div class="template-grid">
          <div class="template-option selected" data-type="business_presentation" onclick="selectType(this)">
            <div class="template-name">ğŸ“Š å•†ä¸šæ±‡æŠ¥</div>
            <div class="template-desc">å­£åº¦æ€»ç»“ã€è¿›åº¦æ±‡æŠ¥</div>
          </div>
          <div class="template-option" data-type="investor_pitch" onclick="selectType(this)">
            <div class="template-name">ğŸ¯ æŠ•èµ„è·¯æ¼”</div>
            <div class="template-desc">åˆ›ä¸šèèµ„ã€VCæ¼”ç¤º</div>
          </div>
          <div class="template-option" data-type="product_launch" onclick="selectType(this)">
            <div class="template-name">ğŸš€ äº§å“å‘å¸ƒ</div>
            <div class="template-desc">æ–°å“å‘å¸ƒã€åŠŸèƒ½ä»‹ç»</div>
          </div>
          <div class="template-option" data-type="training_workshop" onclick="selectType(this)">
            <div class="template-name">ğŸ“š åŸ¹è®­ç ”è®¨</div>
            <div class="template-desc">ä¼ä¸šåŸ¹è®­ã€å·¥ä½œåŠ</div>
          </div>
        </div>
      </div>
      
      <!-- æ¨¡æ¿é€‰æ‹© -->
      <div class="section">
        <h3>ğŸ¨ æ¨¡æ¿é€‰æ‹©</h3>
        <div class="template-grid">
          <div class="template-option selected" data-template="modern-elegant" onclick="selectTemplate(this)">
            <div class="template-preview" style="background: linear-gradient(135deg, #667eea, #764ba2);"></div>
            <div class="template-name">ç°ä»£ä¼˜é›…</div>
            <div class="template-desc">æ¸å˜èƒŒæ™¯ï¼Œé€‚åˆäº§å“å‘å¸ƒ</div>
          </div>
          <div class="template-option" data-template="corporate-blue" onclick="selectTemplate(this)">
            <div class="template-preview" style="background: linear-gradient(180deg, #1a365d, #2b6cb0);"></div>
            <div class="template-name">ä¼ä¸šè“è°ƒ</div>
            <div class="template-desc">ä¸“ä¸šå•†åŠ¡é£æ ¼</div>
          </div>
          <div class="template-option" data-template="minimal-clean" onclick="selectTemplate(this)">
            <div class="template-preview" style="background: #ffffff; border: 1px solid #e5e7eb;"></div>
            <div class="template-name">æç®€çº¯å‡€</div>
            <div class="template-desc">æç®€ä¸»ä¹‰è®¾è®¡</div>
          </div>
          <div class="template-option" data-template="creative-bold" onclick="selectTemplate(this)">
            <div class="template-preview" style="background: linear-gradient(135deg, #0a0a0f, #1a1a2e);"></div>
            <div class="template-name">åˆ›æ„å¤§èƒ†</div>
            <div class="template-desc">èµ›åšæœ‹å…‹é£æ ¼</div>
          </div>
        </div>
      </div>
      
      <!-- ç”ŸæˆæŒ‰é’® -->
      <button class="btn" id="generateBtn" onclick="generate()">
        ğŸš€ ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿
      </button>
      
      <!-- åŠ è½½åŠ¨ç”» -->
      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>AI æ­£åœ¨ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿ï¼Œè¯·ç¨å€™...</p>
      </div>
      
      <!-- ç»“æœå±•ç¤º -->
      <div class="result" id="result">
        <h4 style="color: #10b981; margin-bottom: 15px;">âœ… æ¼”ç¤ºæ–‡ç¨¿ç”ŸæˆæˆåŠŸ!</h4>
        <p style="margin-bottom: 15px; color: #666;">æ‚¨çš„æ¼”ç¤ºæ–‡ç¨¿å·²å‡†å¤‡å°±ç»ªã€‚</p>
        <a href="#" id="downloadLink" target="_blank">ğŸ“¥ æ‰“å¼€æ¼”ç¤ºæ–‡ç¨¿</a>
      </div>
      
      <!-- å‘½ä»¤è¡Œæ–¹å¼ -->
      <div class="info-box">
        <h4>ğŸ’» å‘½ä»¤è¡Œæ–¹å¼</h4>
        <p>å¦‚æœç½‘é¡µç”Ÿæˆå¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œç”Ÿæˆï¼š</p>
        <div class="command-box">
          cd .claude/skills/ui-ux-pro-max/scripts<br>
          python3 search.py "<code id="cmdTopic">ä½ çš„ä¸»é¢˜</code>" --presentation \<br>
          --type <code id="cmdType">business_presentation</code> \<br>
          --output demo.html --presentation-format reveal_js
        </div>
      </div>
    </div>
    
    <div style="text-align: center; margin-top: 30px; color: white; opacity: 0.8;">
      <p>Powered by AI | å¿«é€Ÿç”Ÿæˆä¸“ä¸šæ¼”ç¤ºæ–‡ç¨¿</p>
    </div>
  </div>
  
  <script>
    let selectedType = 'business_presentation';
    let selectedTemplate = 'modern-elegant';
    
    function selectType(el) {
      document.querySelectorAll('[data-type]').forEach(d => d.classList.remove('selected'));
      el.classList.add('selected');
      selectedType = el.dataset.type;
      updateCommand();
    }
    
    function selectTemplate(el) {
      document.querySelectorAll('[data-template]').forEach(d => d.classList.remove('selected'));
      el.classList.add('selected');
      selectedTemplate = el.dataset.template;
    }
    
    function updateCommand() {
      const topic = document.getElementById('topic').value || 'ä½ çš„ä¸»é¢˜';
      document.getElementById('cmdTopic').textContent = topic;
      document.getElementById('cmdType').textContent = selectedType;
    }
    
    document.getElementById('topic').addEventListener('input', updateCommand);
    
    async function generate() {
      const topic = document.getElementById('topic').value.trim();
      if (!topic) {
        alert('è¯·è¾“å…¥æ¼”ç¤ºä¸»é¢˜');
        return;
      }
      
      const btn = document.getElementById('generateBtn');
      const loading = document.getElementById('loading');
      const result = document.getElementById('result');
      
      btn.disabled = true;
      btn.textContent = 'ç”Ÿæˆä¸­...';
      loading.classList.add('show');
      result.classList.remove('show');
      
      try {
        // è°ƒç”¨ Python è„šæœ¬ç”Ÿæˆ
        const { spawn } = require('child_process');
        
        const python = spawn('python3', [
          './.claude/skills/ui-ux-pro-max/scripts/search.py',
          topic,
          '--presentation',
          '--type', selectedType,
          '--output', './output/presentation_' + Date.now() + '.html',
          '--presentation-format', 'reveal_js'
        ]);
        
        let stdout = '';
        let stderr = '';
        
        python.stdout.on('data', (data) => {
          stdout += data.toString();
        });
        
        python.stderr.on('data', (data) => {
          stderr += data.toString();
        });
        
        python.on('close', (code) => {
          btn.disabled = false;
          btn.textContent = 'ğŸš€ ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿';
          loading.classList.remove('show');
          
          // æŸ¥æ‰¾ç”Ÿæˆçš„æ–‡ä»¶
          const fs = require('fs');
          const outputDir = './output';
          
          if (fs.existsSync(outputDir)) {
            const files = fs.readdirSync(outputDir)
              .filter(f => f.startsWith('presentation_') && f.endsWith('.html'))
              .sort()
              .reverse();
            
            if (files.length > 0) {
              const filePath = './output/' + files[0];
              result.classList.add('show');
              document.getElementById('downloadLink').href = filePath;
            } else {
              alert('ç”Ÿæˆå¤±è´¥ï¼Œè¯·ä½¿ç”¨å‘½ä»¤è¡Œæ–¹å¼');
            }
          } else {
            alert('ç”Ÿæˆå¤±è´¥ï¼Œè¯·ä½¿ç”¨å‘½ä»¤è¡Œæ–¹å¼');
          }
        });
      } catch (e) {
        btn.disabled = false;
        btn.textContent = 'ğŸš€ ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿';
        loading.classList.remove('show');
        alert('ç”Ÿæˆå¤±è´¥ï¼Œè¯·ä½¿ç”¨å‘½ä»¤è¡Œæ–¹å¼');
      }
    }
  </script>
</body>
</html>
